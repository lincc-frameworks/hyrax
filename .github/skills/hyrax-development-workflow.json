{
  "name": "Hyrax Development Workflow",
  "description": "Guide through the complete development workflow for Hyrax: setup → code → test → commit",
  "version": "1.0.0",
  "tags": ["development", "workflow", "setup", "testing"],
  "instructions": "This skill provides structured guidance for the Hyrax development workflow, including setup, validation, and commit procedures.\n\n## When to Use\n\nUse this skill when:\n- Setting up a new development environment for Hyrax\n- Validating code changes before committing\n- Running pre-commit hooks and ensuring code quality\n- Unsure about which commands to run or their expected duration\n\n## Workflow Steps\n\n### 1. Environment Setup\n\n```bash\n# Create and activate virtual environment\nconda create -n hyrax python=3.10 && conda activate hyrax\n\n# Clone and navigate to repository\ngit clone https://github.com/lincc-frameworks/hyrax.git && cd hyrax\n\n# Automated setup (RECOMMENDED)\necho 'y' | bash .setup_dev.sh\n# Duration: 5-15 minutes, NEVER CANCEL (wait at least 20 minutes)\n# Installs with pip install -e .'[dev]' and sets up pre-commit hooks\n# Prompts for system install if no venv - respond 'y'\n\n# Alternative: Manual installation\npip install -e .'[dev]' && pre-commit install\n# Duration: 5-15 minutes, NEVER CANCEL (wait at least 20 minutes)\n```\n\n**Network Issues**: Installation commands may encounter `ReadTimeoutError` from PyPI:\n1. Wait 1-2 minutes\n2. Retry the exact same command\n3. May require 3-5 retry attempts to succeed\n\n### 2. Making Code Changes\n\n1. **Always validate first**: Run relevant fast tests to establish baseline\n2. **Make minimal, surgical changes**: Change only what's necessary\n3. **Test immediately**: Run targeted tests after each change\n\n### 3. Validation Workflow (CRITICAL)\n\n**ALWAYS run these steps after making code changes:**\n\n```bash\n# Step 1: Format and lint (30 seconds)\nruff format . && ruff check --fix .\n\n# Step 2: Fast tests (2-5 minutes, NEVER CANCEL - wait at least 10 minutes)\npytest -m \"not slow\"\n\n# Step 3: Pre-commit hooks (3-8 minutes, NEVER CANCEL - wait at least 15 minutes)\npre-commit run --all-files\n```\n\n**Manual validation scenarios** (when automated tests aren't sufficient):\n```bash\n# Verify CLI functionality\nhyrax --help && hyrax --version\n\n# Test import and basic construction\npython -c \"import hyrax; h = hyrax.Hyrax(); print('Success')\"\n\n# Test relevant verbs\nhyrax <verb> --help\n```\n\n### 4. Command Timeout Reference\n\n**CRITICAL: Never cancel these commands prematurely**\n\n| Command | Typical Duration | Minimum Timeout |\n|---------|------------------|----------------|\n| `bash .setup_dev.sh` | 5-15 min | 20+ minutes |\n| `pip install -e .'[dev]'` | 5-15 min | 20+ minutes |\n| `pytest -m \"not slow\"` | 2-5 min | 10+ minutes |\n| `pytest` (all tests) | 15-25 min | 45+ minutes |\n| `pytest -m slow` | 10-20 min | 30+ minutes |\n| `pre-commit run --all-files` | 3-8 min | 15+ minutes |\n| `sphinx-build` (docs) | 2-4 min | 10+ minutes |\n| `ruff format/check` | 10-30 sec | 2 minutes |\n\n### 5. Committing Changes\n\n- Use `report_progress` tool to commit and push changes\n- Do NOT use `git commit` or `git push` directly\n- Review files committed by `report_progress`\n- Use `.gitignore` to exclude build artifacts, temp files, dependencies\n\n### 6. Pre-commit Hooks\n\nThe pre-commit hooks automatically run:\n- ruff linting and formatting\n- pytest fast tests (not slow)\n- sphinx documentation build\n- jupyter notebook conversion\n- Custom hook: prevents note-to-self comments\n\n## Common Issues\n\n### Setup Issues\n- **ReadTimeoutError during pip install**: Retry 3-5 times with 1-2 min waits\n- **CLI not found after install**: Check with `pip list | grep hyrax`\n- **Pre-commit not running**: Ensure `pre-commit install` was executed\n- **Import errors**: Verify `pip install -e .'[dev]'` completed successfully\n\n### Validation Issues\n- **Tests canceled prematurely**: Commands need full timeout duration\n- **Network failures in tests**: Tests use Pooch for downloads - retry if network fails\n- **Pre-commit failures**: Address each failure individually, don't skip\n\n## Best Practices\n\n1. **Always use virtual environment**: Avoid system Python conflicts\n2. **Run validation early and often**: Catch issues before they compound\n3. **Never cancel long-running commands**: They need time to complete\n4. **Test incrementally**: Run targeted tests after each change\n5. **Format before testing**: Fix style issues first with ruff\n\n## Related Skills\n\n- For testing details, see: **Hyrax Testing Strategy**\n- For adding components, see: **Adding Hyrax Components**\n- For config changes, see: **Hyrax Configuration System**\n\n## References\n\n- Full details: [HYRAX_GUIDE.md](../../HYRAX_GUIDE.md)\n- Claude-specific: [CLAUDE.md](../../CLAUDE.md)\n- Copilot-specific: [.github/copilot-instructions.md](../copilot-instructions.md)"
}
